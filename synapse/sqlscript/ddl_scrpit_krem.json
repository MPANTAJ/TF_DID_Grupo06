{
	"name": "ddl_scrpit_krem",
	"properties": {
		"content": {
			"query": "USE datamart_krem;\nGO\n\nDROP EXTERNAL TABLE kremg6.fmv_ventas; \n\n--1. Validacion de Datos utilizando ExternalDataSourceKrem\nSELECT * \nFROM OPENROWSET (\nBULK '/master/warehouse/FMV_VENTAS.parquet',\nDATA_SOURCE= 'ExternalDataSourceKrem',\nFORMAT ='PARQUET') AS [file]\nGO\n\n--2. Creación de tabla externa\nCREATE EXTERNAL TABLE kremg6.FMV_VENTAS\n(    \nFECHA_DESEMBOLSO VARCHAR(100),\nID_HOGAR         VARCHAR(100),    \nUBIGEO           VARCHAR(100),    \nCOD_ETP          VARCHAR(100),    \nMONTO_BFH        VARCHAR(100),    \nMONTO_AHORRO     VARCHAR(100),\nVALOR_OBRA_VIVIENDA VARCHAR(100),\nCOD_MODALIDAD    VARCHAR(100) )\nWITH (\n    LOCATION = '/master/warehouse/FMV_VENTAS.parquet',   \n    DATA_SOURCE = ExternalDataSourceKrem,\n    FILE_FORMAT = UPParquetFileFormat);\nGO\n\n--3. Validacion de Datos utilizando ExternalDataSourceKrem\nSELECT * \nFROM OPENROWSET (\nBULK '/master/warehouse/FMV_PROMOTOR.parquet',\nDATA_SOURCE= 'ExternalDataSourceKrem',\nFORMAT ='PARQUET') AS [file]\nGO\n\n--4. Creación de tabla externa\nCREATE EXTERNAL TABLE kremg6.FMV_PROMOTOR\n(    \nCOD_ETP                  VARCHAR(100),\nENTIDAD_TECNICA_PROMOTOR VARCHAR(100) )\nWITH (\n    LOCATION = '/master/warehouse/FMV_PROMOTOR.parquet',   \n    DATA_SOURCE = ExternalDataSourceKrem,\n    FILE_FORMAT = UPParquetFileFormat);\nGO\n\n--5. Validacion de Datos utilizando ExternalDataSourceKrem\nSELECT * \nFROM OPENROWSET (\nBULK '/master/warehouse/FMV_MODALIDAD.parquet',\nDATA_SOURCE= 'ExternalDataSourceKrem',\nFORMAT ='PARQUET') AS [file]\nGO\n\n--6. Creación de tabla externa\nCREATE EXTERNAL TABLE kremg6.FMV_MODALIDAD\n(    \nCOD_MODALIDAD     VARCHAR(100),\nNOM_MODALIDAD     VARCHAR(100) )\nWITH (\n    LOCATION = '/master/warehouse/FMV_MODALIDAD.parquet',   \n    DATA_SOURCE = ExternalDataSourceKrem,\n    FILE_FORMAT = UPParquetFileFormat);\nGO\n\n--7. Validacion de Datos utilizando ExternalDataSourceKrem\nSELECT * \nFROM OPENROWSET (\nBULK '/master/warehouse/FMV_UBIGEO.parquet',\nDATA_SOURCE= 'ExternalDataSourceKrem',\nFORMAT ='PARQUET') AS [file]\nGO\n\n--8. Creación de tabla externa\nCREATE EXTERNAL TABLE kremg6.FMV_UBIGEO\n(    \nUBIGEO        VARCHAR(100),\nNOMBDEP       VARCHAR(100),\nNOMBPROV      VARCHAR(100),\nNOMBDIST      VARCHAR(100),\nNOM_CAPITAL   VARCHAR(100),\nCOD_REG_NAT   VARCHAR(100),\nREGION_NATURAL   VARCHAR(100) )\nWITH (\n    LOCATION = '/master/warehouse/FMV_UBIGEO.parquet',   \n    DATA_SOURCE = ExternalDataSourceKrem,\n    FILE_FORMAT = UPParquetFileFormat);\nGO\n\n--9. Validacion de Datos utilizando ExternalDataSourceKrem\nSELECT * \nFROM OPENROWSET (\nBULK '/master/warehouse/FMV_HOG_BENEF.parquet',\nDATA_SOURCE= 'ExternalDataSourceKrem',\nFORMAT ='PARQUET') AS [file]\nGO\n\n--10. Creación de tabla externa\nCREATE EXTERNAL TABLE kremg6.FMV_HOG_BENEF\n(    \nID_HOGAR          VARCHAR(100),\nID_BENEFICIARIO   VARCHAR(100) )\nWITH (\n    LOCATION = '/master/warehouse/FMV_HOG_BENEF.parquet',   \n    DATA_SOURCE = ExternalDataSourceKrem,\n    FILE_FORMAT = UPParquetFileFormat);\nGO\n\n--11. Validacion de Datos utilizando ExternalDataSourceKrem\nSELECT * \nFROM OPENROWSET (\nBULK '/master/warehouse/FMV_BENEFICIARIO.parquet',\nDATA_SOURCE= 'ExternalDataSourceKrem',\nFORMAT ='PARQUET') AS [file]\nGO\n\n--12. Creación de tabla externa\nCREATE EXTERNAL TABLE kremg6.FMV_BENEFICIARIO\n(    \nID_BENEFICIARIO      VARCHAR(100),\nFECHA_NACIMIENTO     VARCHAR(100),\nTIPO_PARENTESCO      VARCHAR(100),\nEDAD                 VARCHAR(100),\nID_OCUPACION         VARCHAR(100),\nID_ESTADOCIVIL       VARCHAR(100),\nID_GRADOINSTRUCCION  VARCHAR(100) )\nWITH (\n    LOCATION = '/master/warehouse/FMV_BENEFICIARIO.parquet',   \n    DATA_SOURCE = ExternalDataSourceKrem,\n    FILE_FORMAT = UPParquetFileFormat);\nGO\n\n--13. Validacion de Datos utilizando ExternalDataSourceKrem\nSELECT * \nFROM OPENROWSET (\nBULK '/master/warehouse/FMV_PEA.parquet',\nDATA_SOURCE= 'ExternalDataSourceKrem',\nFORMAT ='PARQUET') AS [file]\nGO\n\n--14. Creación de tabla externa\nCREATE EXTERNAL TABLE kremg6.FMV_PEA\n(    \nUBIGEO     VARCHAR(100),\nANIO       VARCHAR(100),\nMONTO_PEA  VARCHAR(100) )\nWITH (\n    LOCATION = '/master/warehouse/FMV_PEA.parquet',   \n    DATA_SOURCE = ExternalDataSourceKrem,\n    FILE_FORMAT = UPParquetFileFormat);\nGO\n\n--15. Validacion de Datos utilizando ExternalDataSourceKrem\nSELECT * \nFROM OPENROWSET (\nBULK '/master/warehouse/FMV_OCUPACION.parquet',\nDATA_SOURCE= 'ExternalDataSourceKrem',\nFORMAT ='PARQUET') AS [file]\nGO\n\n--16. Creación de tabla externa\nCREATE EXTERNAL TABLE kremg6.FMV_OCUPACION\n(    \nID_OCUPACION   VARCHAR(100),\nDESC_OCUPACION  VARCHAR(100) )\nWITH (\n    LOCATION = '/master/warehouse/FMV_OCUPACION.parquet',   \n    DATA_SOURCE = ExternalDataSourceKrem,\n    FILE_FORMAT = UPParquetFileFormat);\nGO\n\n--17. Validacion de Datos utilizando ExternalDataSourceKrem\nSELECT * \nFROM OPENROWSET (\nBULK '/master/warehouse/FMV_ESTADOCIVIL.parquet',\nDATA_SOURCE= 'ExternalDataSourceKrem',\nFORMAT ='PARQUET') AS [file]\nGO\n\n--18. Creación de tabla externa\nDROP EXTERNAL TABLE kremg6.FMV_ESTADOCIVIL;\nCREATE EXTERNAL TABLE kremg6.FMV_ESTADOCIVIL\n(    \nID_ESTADOCIVIL VARCHAR(100),\nDESC_ESTCIVIL  VARCHAR(100) )\nWITH (\n    LOCATION = '/master/warehouse/FMV_ESTADOCIVIL.parquet',   \n    DATA_SOURCE = ExternalDataSourceKrem,\n    FILE_FORMAT = UPParquetFileFormat);\nGO\n\nSELECT * FROM kremg6.FMV_ESTADOCIVIL;\n\n--19. Validacion de Datos utilizando ExternalDataSourceKrem\nSELECT * \nFROM OPENROWSET (\nBULK '/master/warehouse/FMV_GRADOINSTRUCCION.parquet',\nDATA_SOURCE= 'ExternalDataSourceKrem',\nFORMAT ='PARQUET') AS [file]\nGO\n\n--20. Creación de tabla externa\nCREATE EXTERNAL TABLE kremg6.FMV_GRADOINSTRUCCION\n(    \nID_GRADOINSTRUCCION   VARCHAR(100),\nDESC_GRADOINSTRUCCION  VARCHAR(100) )\nWITH (\n    LOCATION = '/master/warehouse/FMV_GRADOINSTRUCCION.parquet',   \n    DATA_SOURCE = ExternalDataSourceKrem,\n    FILE_FORMAT = UPParquetFileFormat);\nGO\n\nSELECT * FROM kremg6.FMV_GRADOINSTRUCCION;",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "datamart_krem",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}